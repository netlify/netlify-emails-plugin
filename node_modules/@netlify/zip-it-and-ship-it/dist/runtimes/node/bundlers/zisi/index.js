"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const base_path_js_1 = require("../../utils/base_path.js");
const src_files_js_1 = require("./src_files.js");
const bundle = async ({ basePath, config, extension, featureFlags, filename, mainFile, name, pluginsModulesPath, runtime, srcDir, srcPath, stat, }) => {
    const { srcFiles, includedFiles } = await (0, src_files_js_1.getSrcFiles)({
        basePath,
        config: {
            ...config,
            includedFilesBasePath: config.includedFilesBasePath || basePath,
        },
        extension,
        featureFlags,
        filename,
        mainFile,
        name,
        pluginsModulesPath,
        runtime,
        srcDir,
        srcPath,
        stat,
    });
    const dirnames = srcFiles.map((filePath) => (0, path_1.normalize)((0, path_1.dirname)(filePath)));
    return {
        basePath: (0, base_path_js_1.getBasePath)(dirnames),
        includedFiles,
        inputs: srcFiles,
        mainFile,
        moduleFormat: 'cjs',
        srcFiles,
    };
};
const bundler = { bundle, getSrcFiles: src_files_js_1.getSrcFiles };
exports.default = bundler;
//# sourceMappingURL=index.js.map